<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DQNì€ ë­ê°€ ë‹¤ë¥¼ê¹Œ? - Section 7</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fafafa;
            color: #333;
            line-height: 1.9;
        }
        .container { max-width: 800px; margin: 0 auto; padding: 60px 20px; }
        .breadcrumb { margin-bottom: 24px; font-size: 0.9rem; }
        .breadcrumb a { color: #666; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 8px; }
        .header { margin-bottom: 48px; }
        .topic-number {
            display: inline-block;
            background: #FF5722;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 16px;
        }
        .header h1 { font-size: 2rem; font-weight: 700; color: #111; margin-bottom: 12px; }
        .header p { color: #666; font-size: 1.1rem; }
        .conversation {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin: 32px 0;
            border: 1px solid #e0e0e0;
        }
        .conversation h2 {
            font-size: 1.3rem;
            color: #FF5722;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #ffebe9;
        }
        .chat { margin-bottom: 20px; }
        .q {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 16px 20px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
            font-weight: 500;
        }
        .q::before { content: "Q. "; color: #e65100; font-weight: 700; }
        .a { padding: 8px 0 8px 20px; border-left: 4px solid #e0e0e0; margin: 12px 0; }
        .a p { margin-bottom: 12px; }
        .a p:last-child { margin-bottom: 0; }
        .highlight {
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #1565c0;
        }
        .key-point {
            background: #ffccbc;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #d84315;
        }
        .warning {
            background: #ffcdd2;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #c62828;
        }
        .code-block {
            background: #263238;
            border-radius: 8px;
            padding: 16px 20px;
            margin: 16px 0;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            color: #eceff1;
            overflow-x: auto;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .compare-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 0.9rem;
        }
        .compare-table th, .compare-table td {
            padding: 12px;
            border: 1px solid #e0e0e0;
            text-align: left;
        }
        .compare-table th { background: #f5f5f5; font-weight: 600; }
        .summary-box {
            background: linear-gradient(135deg, #FF5722 0%, #FF7043 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            margin: 32px 0;
        }
        .summary-box h3 { font-size: 1.2rem; margin-bottom: 20px; }
        .summary-box ul { list-style: none; }
        .summary-box li { padding: 8px 0; padding-left: 24px; position: relative; }
        .summary-box li::before { content: "â†’"; position: absolute; left: 0; color: #ffccbc; }
        .nav-links {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 24px;
            border-top: 1px solid #e0e0e0;
        }
        .nav-links a { color: #FF5722; text-decoration: none; font-weight: 500; }
        .nav-links a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../../">AI ê³µë¶€</a>
            <span>/</span>
            <a href="../">Section 7</a>
            <span>/</span>
            Topic 09
        </nav>

        <header class="header">
            <div class="topic-number">TOPIC 09</div>
            <h1>DQNì€ ë­ê°€ ë‹¤ë¥¼ê¹Œ?</h1>
            <p>Q. Q-ëŸ¬ë‹ì— ë”¥ëŸ¬ë‹ì„ í•©ì³¤ë‹¤ê³ ?</p>
        </header>

        <div class="conversation">
            <h2>Part 1. DQNì´ë€?</h2>

            <div class="chat">
                <div class="q">DQNì´ ë­ì•¼?</div>
                <div class="a">
                    <p><span class="key-point">DQN = Deep Q-Network</span></p>
                    <p>Q-ëŸ¬ë‹ + ë”¥ëŸ¬ë‹(ì‹ ê²½ë§)ì„ í•©ì¹œ ê±°ì•¼.</p>
                    <p>2013ë…„ DeepMindê°€ ë°œí‘œí•´ì„œ <strong>ê°•í™”í•™ìŠµ ì—­ì‚¬ë¥¼ ë°”ê¿¨ì–´</strong>.</p>
                </div>
            </div>

            <div class="code-block">Q-ëŸ¬ë‹ vs DQN:

Q-ëŸ¬ë‹:
Q í…Œì´ë¸” ì‚¬ìš©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ìƒíƒœ     â”‚ Qê°’ë“¤  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â†’ ìƒíƒœê°€ ì ì„ ë•Œë§Œ ê°€ëŠ¥

DQN:
ì‹ ê²½ë§ ì‚¬ìš©
ê²Œì„ í™”ë©´ â†’ [ì‹ ê²½ë§] â†’ Qê°’ë“¤
â†’ ë³µì¡í•œ ìƒíƒœë„ ì²˜ë¦¬ ê°€ëŠ¥!


í•µì‹¬ ì°¨ì´:
Q-ëŸ¬ë‹: í…Œì´ë¸”ì— ê°’ ì €ì¥
DQN: í•¨ìˆ˜(ì‹ ê²½ë§)ë¡œ Qê°’ ì˜ˆì¸¡</div>

            <div class="chat">
                <div class="q">ì™œ ì¤‘ìš”í•œë°?</div>
                <div class="a">
                    <p><span class="highlight">ì•„íƒ€ë¦¬ ê²Œì„ì„ ì¸ê°„ ìˆ˜ì¤€ìœ¼ë¡œ í”Œë ˆì´</span>í•œ ì²« AIì•¼.</p>
                    <p>ê²Œì„ í™”ë©´(í”½ì…€)ë§Œ ë³´ê³  í•™ìŠµí–ˆì–´. <strong>ì—„ì²­ë‚œ ëŒíŒŒêµ¬</strong>ì˜€ì§€.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 2. Q í…Œì´ë¸”ì˜ í•œê³„</h2>

            <div class="chat">
                <div class="q">Q í…Œì´ë¸”ì´ ë­ê°€ ë¬¸ì œì˜€ì–´?</div>
                <div class="a">
                    <p>ìƒíƒœ ê³µê°„ì´ ì¡°ê¸ˆë§Œ ì»¤ì ¸ë„ ë¶ˆê°€ëŠ¥í•´ì ¸.</p>
                </div>
            </div>

            <div class="code-block">ìƒíƒœ ê³µê°„ í­ë°œ:

ê·¸ë¦¬ë“œ ì›”ë“œ (10Ã—10):
â†’ ìƒíƒœ 100ê°œ
â†’ Q í…Œì´ë¸” ê°€ëŠ¥!

ì²´ìŠ¤:
â†’ ìƒíƒœ 10^47ê°œ
â†’ Q í…Œì´ë¸” ë¶ˆê°€ëŠ¥... (ìš°ì£¼ ì›ìë³´ë‹¤ ë§ìŒ)

ì•„íƒ€ë¦¬ ê²Œì„ (Breakout):
â†’ í™”ë©´ 210Ã—160 í”½ì…€ Ã— RGB
â†’ ìƒíƒœ 256^(210Ã—160Ã—3) ê°œ
â†’ ì™„ì „íˆ ë¶ˆê°€ëŠ¥...!!!


ë¬¸ì œ:
1. ë©”ëª¨ë¦¬ ë¶€ì¡±
2. ëª¨ë“  ìƒíƒœ ë°©ë¬¸ ë¶ˆê°€ëŠ¥
3. ë¹„ìŠ·í•œ ìƒíƒœì¸ë° ë³„ê°œë¡œ ì·¨ê¸‰</div>

            <div class="chat">
                <div class="q">ê·¸ë˜ì„œ ì–´ë–»ê²Œ í•´ê²°í–ˆì–´?</div>
                <div class="a">
                    <p><span class="highlight">í…Œì´ë¸” ëŒ€ì‹  í•¨ìˆ˜ ê·¼ì‚¬(Function Approximation)</span>ë¥¼ ì¨.</p>
                    <p>ì‹ ê²½ë§ìœ¼ë¡œ Qê°’ì„ <strong>ì˜ˆì¸¡</strong>í•˜ëŠ” ê±°ì•¼.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 3. DQNì˜ êµ¬ì¡°</h2>

            <div class="chat">
                <div class="q">DQNì€ ì–´ë–»ê²Œ ìƒê²¼ì–´?</div>
                <div class="a">
                    <p>CNN(í•©ì„±ê³± ì‹ ê²½ë§)ì„ ì‚¬ìš©í•´.</p>
                </div>
            </div>

            <div class="code-block">DQN ì•„í‚¤í…ì²˜:

ì…ë ¥: ê²Œì„ í™”ë©´ (84Ã—84Ã—4)
      â†“
Conv Layer 1: 32 filters (8Ã—8, stride 4)
      â†“
Conv Layer 2: 64 filters (4Ã—4, stride 2)
      â†“
Conv Layer 3: 64 filters (3Ã—3, stride 1)
      â†“
Fully Connected: 512 units
      â†“
ì¶œë ¥: Q(s, a) for each action
      [Q(s, ìœ„), Q(s, ì•„ë˜), Q(s, ì¢Œ), Q(s, ìš°)]


ì˜ˆì‹œ (Breakout):
ì…ë ¥: ê²Œì„ í™”ë©´
ì¶œë ¥: [Q(ì •ì§€)=2.3, Q(ì¢Œ)=5.1, Q(ìš°)=3.8]
      â†’ "ì¢Œ" ì„ íƒ!</div>

            <div class="code-block">í…Œì´ë¸” vs ì‹ ê²½ë§:

Q-ëŸ¬ë‹ (í…Œì´ë¸”):
Q[(state=10, action=ìœ„)] = 5.2
â†’ ì •í™•íˆ ì´ ìƒíƒœ-í–‰ë™ë§Œ

DQN (ì‹ ê²½ë§):
Q_network(state=10) â†’ [5.2, 3.1, 4.5, 2.9]
â†’ ë¹„ìŠ·í•œ ìƒíƒœë„ ì¼ë°˜í™”!

ì˜ˆ:
state=10: Q(ìœ„)=5.2 í•™ìŠµ
state=11: Q(ìœ„)=5.1 ìë™ ì˜ˆì¸¡ (ì¼ë°˜í™”!)

â†’ ëª¨ë“  ìƒíƒœë¥¼ ë°©ë¬¸ ì•ˆ í•´ë„ ë¨</div>
        </div>

        <div class="conversation">
            <h2>Part 4. DQNì˜ í•µì‹¬ ê¸°ë²•ë“¤</h2>

            <div class="chat">
                <div class="q">ê·¸ëƒ¥ ì‹ ê²½ë§ìœ¼ë¡œ Q-ëŸ¬ë‹í•˜ë©´ ì•ˆ ë¼?</div>
                <div class="a">
                    <p><span class="warning">ì•ˆì •ì ìœ¼ë¡œ í•™ìŠµì´ ì•ˆ ë¼.</span></p>
                    <p>DQNì€ ë‘ ê°€ì§€ í•µì‹¬ ê¸°ë²•ì„ ì¶”ê°€í–ˆì–´.</p>
                </div>
            </div>

            <div class="code-block">1. ê²½í—˜ ì¬ìƒ (Experience Replay)

ë¬¸ì œ:
â†’ ì—°ì†ëœ ê²½í—˜ì´ ë„ˆë¬´ ë¹„ìŠ·í•¨
â†’ ì‹ ê²½ë§ì´ ìµœê·¼ ê²½í—˜ì—ë§Œ í¸í–¥ë¨

í•´ê²°:
ë©”ëª¨ë¦¬ì— ê²½í—˜ ì €ì¥
memory = []
memory.append((state, action, reward, next_state))

í•™ìŠµ ì‹œ ëœë¤ ìƒ˜í”Œë§
batch = random_sample(memory, size=32)
for (s, a, r, s') in batch:
    Q ë„¤íŠ¸ì›Œí¬ ì—…ë°ì´íŠ¸

íš¨ê³¼:
â†’ ë‹¤ì–‘í•œ ê²½í—˜ìœ¼ë¡œ í•™ìŠµ
â†’ ìƒê´€ê´€ê³„ ì œê±°
â†’ ì•ˆì •ì  í•™ìŠµ</div>

            <div class="code-block">2. íƒ€ê²Ÿ ë„¤íŠ¸ì›Œí¬ (Target Network)

ë¬¸ì œ:
â†’ ì˜ˆì¸¡ê°’ê³¼ ëª©í‘œê°’ì´ ê°™ì€ ë„¤íŠ¸ì›Œí¬
â†’ ëª©í‘œê°€ ê³„ì† ì›€ì§ì„ (moving target)
â†’ í•™ìŠµ ë¶ˆì•ˆì •

í•´ê²°:
ë„¤íŠ¸ì›Œí¬ 2ê°œ ì‚¬ìš©!

Q_network: í•™ìŠµí•˜ëŠ” ë„¤íŠ¸ì›Œí¬ (ìì£¼ ì—…ë°ì´íŠ¸)
Q_target: íƒ€ê²Ÿ ê³„ì‚°ìš© ë„¤íŠ¸ì›Œí¬ (ê°€ë” ë³µì‚¬)

ì—…ë°ì´íŠ¸:
target = R + Î³ Ã— max Q_target(s', a')
                    a'
loss = (target - Q_network(s, a))Â²

ì£¼ê¸°ì ìœ¼ë¡œ ë³µì‚¬:
every 10000 steps:
    Q_target â† Q_network

íš¨ê³¼:
â†’ ëª©í‘œê°€ ê³ ì •ë¨
â†’ í•™ìŠµ ì•ˆì •í™”</div>
        </div>

        <div class="conversation">
            <h2>Part 5. DQN ì•Œê³ ë¦¬ì¦˜</h2>

            <div class="chat">
                <div class="q">ì „ì²´ ì•Œê³ ë¦¬ì¦˜ì€?</div>
                <div class="a">
                    <p>ë‹¨ê³„ë³„ë¡œ ë³´ì.</p>
                </div>
            </div>

            <div class="code-block">DQN ì•Œê³ ë¦¬ì¦˜:

# ì´ˆê¸°í™”
Q_network ìƒì„± (ëœë¤ ê°€ì¤‘ì¹˜)
Q_target = Q_network ë³µì‚¬
memory = []
Îµ = 1.0

# í•™ìŠµ ë£¨í”„
for episode in range(num_episodes):
    state = env.reset()

    while not done:
        # 1. í–‰ë™ ì„ íƒ (Îµ-greedy)
        if random() < Îµ:
            action = random_action()
        else:
            q_values = Q_network(state)
            action = argmax(q_values)

        # 2. í–‰ë™ ì‹¤í–‰
        next_state, reward, done = env.step(action)

        # 3. ê²½í—˜ ì €ì¥
        memory.append((state, action, reward, next_state, done))

        # 4. ë°°ì¹˜ í•™ìŠµ
        if len(memory) > batch_size:
            batch = random_sample(memory, batch_size)

            for (s, a, r, s', d) in batch:
                if d:  # ì¢…ë£Œ ìƒíƒœ
                    target = r
                else:
                    target = r + Î³ Ã— max Q_target(s')

                # ê·¸ë˜ë””ì–¸íŠ¸ í•˜ê°•
                loss = (target - Q_network(s, a))Â²
                Q_network ì—…ë°ì´íŠ¸ (ì—­ì „íŒŒ)

        # 5. íƒ€ê²Ÿ ë„¤íŠ¸ì›Œí¬ ì—…ë°ì´íŠ¸
        if step % target_update_freq == 0:
            Q_target â† Q_network

        state = next_state

    Îµ *= Îµ_decay</div>
        </div>

        <div class="conversation">
            <h2>Part 6. DQNì˜ ì„±ê³µ</h2>

            <div class="chat">
                <div class="q">DQNì´ ë­˜ ë‹¬ì„±í–ˆì–´?</div>
                <div class="a">
                    <p>ì•„íƒ€ë¦¬ 2600 ê²Œì„ 49ê°œë¥¼ í•™ìŠµí–ˆì–´.</p>
                </div>
            </div>

            <div class="code-block">DQN ì„±ê³¼ (2015):

ê²Œì„ë³„ ì„±ëŠ¥:

Breakout:
â†’ ì¸ê°„: 31ì 
â†’ DQN: 401ì  (ì¸ê°„ì˜ 13ë°°!)

Space Invaders:
â†’ ì¸ê°„: 1652ì 
â†’ DQN: 3690ì 

Pong:
â†’ ì¸ê°„: -3ì 
â†’ DQN: 20ì  (ì™„ë²½!)

ì´ 49ê°œ ê²Œì„ ì¤‘:
â†’ 29ê°œ: ì¸ê°„ ìˆ˜ì¤€ ì´ìƒ
â†’ 20ê°œ: ì¸ê°„ë³´ë‹¤ ë‚®ìŒ

í•™ìŠµ ë°©ë²•:
â†’ ê²Œì„ í™”ë©´ë§Œ ì…ë ¥
â†’ ê²Œì„ ê·œì¹™ ëª¨ë¦„
â†’ ìë™ìœ¼ë¡œ ì „ëµ ë°œê²¬!</div>

            <div class="code-block">Breakout í•™ìŠµ ê³¼ì •:

0-100 ì—í”¼ì†Œë“œ:
â†’ ê³µì„ ëª» ë°›ìŒ
â†’ ëœë¤í•˜ê²Œ ì›€ì§ì„

100-200 ì—í”¼ì†Œë“œ:
â†’ ê³µì„ ë°›ê¸° ì‹œì‘
â†’ ê°€ë” ë¸”ë¡ íŒŒê´´

200-400 ì—í”¼ì†Œë“œ:
â†’ ì•ˆì •ì ìœ¼ë¡œ í”Œë ˆì´
â†’ ì¸ê°„ ìˆ˜ì¤€ ë„ë‹¬

400+ ì—í”¼ì†Œë“œ:
â†’ ìµœì  ì „ëµ ë°œê²¬!
â†’ ë¸”ë¡ ë’¤ë¡œ ê³µì„ ë³´ë‚´ì„œ ì—„ì²­ë‚œ ì ìˆ˜
â†’ ì¸ê°„ì´ ìƒê° ëª»í•œ ì „ëµ!</div>

            <div class="chat">
                <div class="a">
                    <p><span class="key-point">DQNì€ "í™”ë©´ë§Œ ë³´ê³ " ê²Œì„ì„ ë°°ìš´ ì²« AI</span>ì•¼.</p>
                    <p>ì´ê²Œ <strong>ë”¥ëŸ¬ë‹ + ê°•í™”í•™ìŠµì˜ ì‹œëŒ€</strong>ë¥¼ ì—° ê±°ì§€.</p>
                </div>
            </div>
        </div>

        <div class="summary-box">
            <h3>ğŸ“Œ í•µì‹¬ ì •ë¦¬</h3>
            <ul>
                <li><strong>DQN</strong> - Q-ëŸ¬ë‹ + ë”¥ëŸ¬ë‹, ë³µì¡í•œ ìƒíƒœ ì²˜ë¦¬ ê°€ëŠ¥</li>
                <li><strong>í•¨ìˆ˜ ê·¼ì‚¬</strong> - í…Œì´ë¸” ëŒ€ì‹  ì‹ ê²½ë§ìœ¼ë¡œ Qê°’ ì˜ˆì¸¡</li>
                <li><strong>ê²½í—˜ ì¬ìƒ</strong> - ë©”ëª¨ë¦¬ì— ì €ì¥, ëœë¤ ìƒ˜í”Œë§ìœ¼ë¡œ í•™ìŠµ</li>
                <li><strong>íƒ€ê²Ÿ ë„¤íŠ¸ì›Œí¬</strong> - ì•ˆì •ì  í•™ìŠµì„ ìœ„í•œ ê³ ì • íƒ€ê²Ÿ</li>
                <li><strong>ì„±ê³¼</strong> - ì•„íƒ€ë¦¬ ê²Œì„ ì¸ê°„ ìˆ˜ì¤€ ë‹¬ì„±, ê°•í™”í•™ìŠµ í˜ì‹ </li>
            </ul>
        </div>

        <div class="nav-links">
            <a href="../topic08/">â† ì´ì „: Q-ëŸ¬ë‹ì´ ë­ì•¼?</a>
            <a href="../topic10/">ë‹¤ìŒ: ì•ŒíŒŒê³ ëŠ” ì–´ë–»ê²Œ ì´ê²¼ì–´? â†’</a>
        </div>
    </div>
</body>
</html>
