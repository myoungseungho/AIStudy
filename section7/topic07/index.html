<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가치 함수가 뭐야? - Section 7</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fafafa;
            color: #333;
            line-height: 1.9;
        }
        .container { max-width: 800px; margin: 0 auto; padding: 60px 20px; }
        .breadcrumb { margin-bottom: 24px; font-size: 0.9rem; }
        .breadcrumb a { color: #666; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 8px; }
        .header { margin-bottom: 48px; }
        .topic-number {
            display: inline-block;
            background: #FF5722;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 16px;
        }
        .header h1 { font-size: 2rem; font-weight: 700; color: #111; margin-bottom: 12px; }
        .header p { color: #666; font-size: 1.1rem; }
        .conversation {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin: 32px 0;
            border: 1px solid #e0e0e0;
        }
        .conversation h2 {
            font-size: 1.3rem;
            color: #FF5722;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #ffebe9;
        }
        .chat { margin-bottom: 20px; }
        .q {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 16px 20px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
            font-weight: 500;
        }
        .q::before { content: "Q. "; color: #e65100; font-weight: 700; }
        .a { padding: 8px 0 8px 20px; border-left: 4px solid #e0e0e0; margin: 12px 0; }
        .a p { margin-bottom: 12px; }
        .a p:last-child { margin-bottom: 0; }
        .highlight {
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #1565c0;
        }
        .key-point {
            background: #ffccbc;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #d84315;
        }
        .warning {
            background: #ffcdd2;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #c62828;
        }
        .code-block {
            background: #263238;
            border-radius: 8px;
            padding: 16px 20px;
            margin: 16px 0;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            color: #eceff1;
            overflow-x: auto;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .compare-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 0.9rem;
        }
        .compare-table th, .compare-table td {
            padding: 12px;
            border: 1px solid #e0e0e0;
            text-align: left;
        }
        .compare-table th { background: #f5f5f5; font-weight: 600; }
        .summary-box {
            background: linear-gradient(135deg, #FF5722 0%, #FF7043 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            margin: 32px 0;
        }
        .summary-box h3 { font-size: 1.2rem; margin-bottom: 20px; }
        .summary-box ul { list-style: none; }
        .summary-box li { padding: 8px 0; padding-left: 24px; position: relative; }
        .summary-box li::before { content: "→"; position: absolute; left: 0; color: #ffccbc; }
        .nav-links {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 24px;
            border-top: 1px solid #e0e0e0;
        }
        .nav-links a { color: #FF5722; text-decoration: none; font-weight: 500; }
        .nav-links a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../../">AI 공부</a>
            <span>/</span>
            <a href="../">Section 7</a>
            <span>/</span>
            Topic 07
        </nav>

        <header class="header">
            <div class="topic-number">TOPIC 07</div>
            <h1>가치 함수가 뭐야?</h1>
            <p>Q. 이 상태가 얼마나 좋은지 점수를 매긴다고?</p>
        </header>

        <div class="conversation">
            <h2>Part 1. 가치 함수란?</h2>

            <div class="chat">
                <div class="q">가치 함수(Value Function)가 뭐야?</div>
                <div class="a">
                    <p><span class="key-point">가치 함수는 "이 상태 또는 행동이 얼마나 좋은지" 평가하는 함수</span>야.</p>
                    <p>쉽게 말하면 <strong>"여기 있으면 앞으로 얼마나 보상을 받을 수 있을까?"</strong>를 예측하는 거지.</p>
                </div>
            </div>

            <div class="code-block">비유: 부동산 가치

상황: 집을 사려고 함

위치 A: 역 근처, 학교 근처, 편의시설 많음
→ 가치 높음 (살기 좋음, 재산 가치 상승)

위치 B: 외곽, 접근성 나쁨, 개발 없음
→ 가치 낮음 (불편함, 재산 가치 하락)

→ 가치 함수는 "이 상태의 장기적 가치"를 평가</div>

            <div class="chat">
                <div class="q">왜 가치를 평가해?</div>
                <div class="a">
                    <p><span class="highlight">즉각적 보상만 보면 안 되거든.</span></p>
                    <p>지금 당장은 안 좋아 보여도 <strong>나중에 큰 보상</strong>이 올 수 있어.</p>
                    <p>가치 함수는 <strong>장기적 관점</strong>에서 평가하는 거야.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 2. 상태 가치 함수 V(s)</h2>

            <div class="chat">
                <div class="q">상태 가치 함수가 뭐야?</div>
                <div class="a">
                    <p><span class="key-point">V(s) = 상태 s에 있을 때 기대되는 누적 보상</span></p>
                </div>
            </div>

            <div class="code-block">상태 가치 함수:

V(s) = E[R₁ + γR₂ + γ²R₃ + ... | S₀ = s]

"상태 s에서 시작해서 받을 미래 보상의 합"


예시: 체스

V(시작 판) = 0.0 (중립)
V(내가 퀸을 많이 가진 판) = +0.7 (유리함)
V(상대가 체크메이트 직전 판) = -0.9 (불리함)
V(내가 이긴 판) = +1.0 (최고)
V(내가 진 판) = -1.0 (최악)</div>

            <div class="code-block">슈퍼마리오 예시:

상태: 마리오 위치 (5, 3), 체력 2, 코인 10개

V(이 상태) = 예상 점수

계산 과정:
- 여기서 깃발까지 갈 확률: 60%
- 깃발 도달 시 보상: +1000
- 도중에 먹을 코인: 평균 +50
- 죽을 확률: 40%, 보상: -500

V(5, 3) = 0.6 × (1000 + 50) + 0.4 × (-500)
        = 630 - 200
        = +430

→ 이 상태의 가치는 +430점!</div>

            <div class="chat">
                <div class="a">
                    <p>이해됐어?</p>
                    <p><span class="highlight">상태 가치는 "여기 있으면 얼마나 좋은가"</span>를 나타내.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 3. 행동 가치 함수 Q(s, a)</h2>

            <div class="chat">
                <div class="q">행동 가치 함수는 또 뭐야?</div>
                <div class="a">
                    <p><span class="key-point">Q(s, a) = 상태 s에서 행동 a를 했을 때 기대되는 누적 보상</span></p>
                    <p>상태 가치보다 <strong>더 구체적</strong>이야.</p>
                </div>
            </div>

            <div class="code-block">행동 가치 함수:

Q(s, a) = E[R₁ + γR₂ + γ²R₃ + ... | S₀ = s, A₀ = a]

"상태 s에서 행동 a를 하면 받을 미래 보상"


예시: 팩맨

상태: 유령이 바로 위에 있음

Q(이 상태, 위로 이동) = -100 (유령에게 잡힘!)
Q(이 상태, 아래로 이동) = +50 (안전하게 도망)
Q(이 상태, 좌로 이동) = -50 (막다른 길)
Q(이 상태, 우로 이동) = +30 (괜찮은 경로)

→ "아래로 이동"이 최선!</div>

            <div class="code-block">V(s)와 Q(s, a)의 관계:

V(s) = max Q(s, a)
       a

"상태 가치 = 그 상태에서 가능한 최선의 행동 가치"


또는

V(s) = Σ π(a|s) × Q(s, a)
       a

"정책에 따라 행동할 때의 평균 가치"</div>

            <div class="chat">
                <div class="q">둘 중 어떤 게 더 유용해?</div>
                <div class="a">
                    <p><span class="highlight">Q(s, a)가 더 유용</span>해.</p>
                    <p>왜냐하면 <strong>Q값만 알면 바로 행동 선택</strong>이 가능하거든.</p>
                </div>
            </div>

            <div class="code-block">행동 선택:

V(s)로 행동 선택:
→ 각 행동을 해봐야 다음 상태를 알 수 있음
→ 모든 행동을 시뮬레이션 필요

Q(s, a)로 행동 선택:
→ Q(s, 위) = 10
→ Q(s, 아래) = 30  ← 최대값!
→ Q(s, 좌) = 5
→ Q(s, 우) = 20

→ 바로 "아래" 선택!

→ Q값이 더 직접적이고 편리</div>
        </div>

        <div class="conversation">
            <h2>Part 4. 벨만 방정식</h2>

            <div class="chat">
                <div class="q">가치 함수는 어떻게 계산해?</div>
                <div class="a">
                    <p><span class="key-point">벨만 방정식(Bellman Equation)</span>을 써.</p>
                    <p>강화학습의 가장 핵심적인 수식이야.</p>
                </div>
            </div>

            <div class="code-block">벨만 방정식:

V(s) = 즉각적 보상 + 할인된 미래 가치

V(s) = R(s) + γ × max V(s')
                   a

"현재 상태 가치 = 지금 보상 + 다음 상태 가치"


Q 함수 버전:

Q(s, a) = R(s, a) + γ × max Q(s', a')
                          a'

"이 행동의 가치 = 보상 + 최선의 다음 행동 가치"</div>

            <div class="code-block">예시: 미로 탈출

출구: V(출구) = 0 (도착!)
출구 바로 앞: V = 1 + γ × 0 = 1
출구 2칸 전: V = 0 + γ × 1 = γ
출구 3칸 전: V = 0 + γ × γ = γ²

→ 출구에서 멀수록 가치 감소
→ 할인 계수 γ 때문에 먼 미래는 덜 중요</div>

            <div class="chat">
                <div class="a">
                    <p>벨만 방정식은 <span class="highlight">재귀적</span>이야.</p>
                    <p>한 상태의 가치는 <strong>다음 상태의 가치</strong>로 정의되는 거지.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 5. 가치 함수 학습</h2>

            <div class="chat">
                <div class="q">가치 함수는 어떻게 학습해?</div>
                <div class="a">
                    <p>경험을 통해 점진적으로 업데이트해.</p>
                </div>
            </div>

            <div class="code-block">TD 학습 (Temporal Difference):

현재 예상: V(s) = 100

실제 경험:
→ 보상 R = 10 받음
→ 다음 상태 s'에 도착
→ V(s') = 150으로 추정

TD 타겟:
target = R + γ × V(s')
       = 10 + 0.9 × 150
       = 145

업데이트:
V(s) ← V(s) + α × (target - V(s))
    = 100 + 0.1 × (145 - 100)
    = 100 + 4.5
    = 104.5

→ 예상을 실제에 가깝게 조정</div>

            <div class="code-block">Q 함수 학습:

Q(s, a) ← Q(s, a) + α × [R + γ × max Q(s', a') - Q(s, a)]
                                    a'

1. 행동 a를 실행
2. 보상 R과 다음 상태 s' 관찰
3. 다음 상태의 최선 Q값 확인
4. 현재 Q값을 업데이트

→ 이게 Q-러닝의 기본!</div>

            <div class="chat">
                <div class="a">
                    <p><span class="highlight">가치 함수 학습은 "예측 오차"를 줄이는 과정</span>이야.</p>
                    <p>경험할수록 예측이 정확해지는 거지.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 6. 가치 함수의 활용</h2>

            <div class="chat">
                <div class="q">가치 함수를 어디에 써?</div>
                <div class="a">
                    <p>강화학습의 핵심이야. 거의 모든 곳에 써.</p>
                </div>
            </div>

            <div class="code-block">가치 함수 활용:

1. 행동 선택
   action = argmax Q(s, a)
            a
   → Q값이 가장 큰 행동 선택

2. 정책 평가
   "이 정책은 얼마나 좋은가?"
   → 평균 V(s) 계산

3. 정책 개선
   "어떤 행동이 더 나은가?"
   → Q값 비교

4. 계획 수립
   "어느 경로가 최선인가?"
   → V값이 높은 경로 선택

5. 학습 신호
   TD 오차 = target - prediction
   → 학습에 사용</div>

            <div class="chat">
                <div class="a">
                    <p><span class="key-point">가치 함수 없이는 강화학습이 불가능</span>해.</p>
                    <p>이게 있어야 <strong>"좋은 행동"과 "나쁜 행동"</strong>을 구분할 수 있거든.</p>
                </div>
            </div>
        </div>

        <div class="summary-box">
            <h3>📌 핵심 정리</h3>
            <ul>
                <li><strong>가치 함수</strong> - 상태/행동의 장기적 가치 평가</li>
                <li><strong>V(s)</strong> - 상태 가치 함수 (이 상태의 좋음)</li>
                <li><strong>Q(s, a)</strong> - 행동 가치 함수 (이 행동의 좋음)</li>
                <li><strong>벨만 방정식</strong> - 가치의 재귀적 정의</li>
                <li><strong>TD 학습</strong> - 경험을 통한 점진적 업데이트</li>
            </ul>
        </div>

        <div class="nav-links">
            <a href="../topic06/">← 이전: 정책이 뭐야?</a>
            <a href="../topic08/">다음: Q-러닝이 뭐야? →</a>
        </div>
    </div>
</body>
</html>
