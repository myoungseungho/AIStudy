<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>필터는 어떻게 학습돼? - Section 5</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fafafa;
            color: #333;
            line-height: 1.9;
        }
        .container { max-width: 800px; margin: 0 auto; padding: 60px 20px; }
        .breadcrumb { margin-bottom: 24px; font-size: 0.9rem; }
        .breadcrumb a { color: #666; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 8px; }
        .header { margin-bottom: 48px; }
        .topic-number {
            display: inline-block;
            background: #00BCD4;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 16px;
        }
        .header h1 { font-size: 2rem; font-weight: 700; color: #111; margin-bottom: 12px; }
        .header p { color: #666; font-size: 1.1rem; }
        .conversation {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin: 32px 0;
            border: 1px solid #e0e0e0;
        }
        .conversation h2 {
            font-size: 1.3rem;
            color: #00BCD4;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e0f7fa;
        }
        .chat { margin-bottom: 20px; }
        .q {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 16px 20px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
            font-weight: 500;
        }
        .q::before { content: "Q. "; color: #e65100; font-weight: 700; }
        .a {
            padding: 8px 0 8px 20px;
            border-left: 4px solid #e0e0e0;
            margin: 12px 0;
        }
        .a p { margin-bottom: 12px; }
        .a p:last-child { margin-bottom: 0; }
        .highlight {
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #1565c0;
        }
        .key-point {
            background: #e0f7fa;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #00838f;
        }
        .warning {
            background: #ffcdd2;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #c62828;
        }
        .code-block {
            background: #263238;
            border-radius: 8px;
            padding: 16px 20px;
            margin: 16px 0;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            color: #eceff1;
            overflow-x: auto;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .compare-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 0.9rem;
        }
        .compare-table th, .compare-table td {
            padding: 12px;
            border: 1px solid #e0e0e0;
            text-align: left;
        }
        .compare-table th { background: #f5f5f5; font-weight: 600; }
        .summary-box {
            background: linear-gradient(135deg, #00BCD4 0%, #26C6DA 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            margin: 32px 0;
        }
        .summary-box h3 { font-size: 1.2rem; margin-bottom: 20px; }
        .summary-box ul { list-style: none; }
        .summary-box li {
            padding: 8px 0;
            padding-left: 24px;
            position: relative;
        }
        .summary-box li::before {
            content: "→";
            position: absolute;
            left: 0;
            color: #b2ebf2;
        }
        .nav-links {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 24px;
            border-top: 1px solid #e0e0e0;
        }
        .nav-links a { color: #00BCD4; text-decoration: none; font-weight: 500; }
        .nav-links a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../../">AI 공부</a>
            <span>/</span>
            <a href="../">Section 5</a>
            <span>/</span>
            Topic 06
        </nav>

        <header class="header">
            <div class="topic-number">TOPIC 06</div>
            <h1>필터는 어떻게 학습돼?</h1>
            <p>Q. 엣지, 코너를 찾는 필터가 자동으로 만들어져?</p>
        </header>

        <div class="conversation">
            <h2>Part 1. 필터를 직접 만들어?</h2>

            <div class="chat">
                <div class="q">필터는 사람이 직접 설계하는 거야?</div>
                <div class="a">
                    <p><span class="warning">아니! 자동으로 학습돼.</span></p>
                    <p>그게 딥러닝의 핵심이야.</p>
                </div>
            </div>

            <div class="code-block">전통적인 방법 (딥러닝 이전):
→ 사람이 엣지 검출 필터를 직접 설계
→ Sobel 필터, Canny 엣지 검출 등
→ 수동으로 특징 추출 (Hand-crafted features)

딥러닝 (CNN):
→ 필터 값을 랜덤으로 초기화
→ 학습 과정에서 자동으로 최적화
→ 데이터가 알아서 필터를 만들어줌</div>

            <div class="chat">
                <div class="a">
                    <p><span class="key-point">필터도 가중치의 일종</span>이야.</p>
                    <p>일반 신경망에서 가중치가 학습되듯이, CNN에서는 필터가 학습되는 거지.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 2. 학습 과정</h2>

            <div class="chat">
                <div class="q">구체적으로 어떻게 학습돼?</div>
                <div class="a">
                    <p>역전파(Backpropagation)로 학습해. 일반 신경망과 똑같아.</p>
                </div>
            </div>

            <div class="code-block">학습 과정:

Step 1: 초기화
→ 필터 값을 작은 랜덤 값으로 설정
→ 예: 3×3 필터 = 9개의 랜덤 숫자

Step 2: 순전파 (Forward Pass)
→ 랜덤 필터로 합성곱 수행
→ 특징 맵 생성 → 풀링 → ... → 예측

Step 3: 손실 계산
→ 예측: "강아지"
→ 정답: "고양이"
→ 손실: 크다!

Step 4: 역전파 (Backward Pass)
→ 손실을 줄이려면 필터를 어떻게 바꿔야 할까?
→ 그래디언트 계산

Step 5: 필터 업데이트
→ 필터 값을 조금씩 수정
→ 예: [1, 0, -1] → [0.9, 0.1, -0.8]

반복 → 수천 번 → 최적의 필터</div>

            <div class="chat">
                <div class="a">
                    <p>이해됐어?</p>
                    <p><span class="highlight">필터는 "학습 가능한 파라미터"</span>야.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 3. 자동으로 엣지 검출기가 만들어진다고?</h2>

            <div class="chat">
                <div class="q">그럼 AI가 알아서 "엣지를 찾아야겠다"고 생각하는 거야?</div>
                <div class="a">
                    <p><span class="warning">아니. AI는 "생각" 안 해.</span></p>
                    <p>그냥 <strong>손실을 줄이는 방향</strong>으로 필터가 변할 뿐이야.</p>
                </div>
            </div>

            <div class="code-block">왜 엣지 검출기가 만들어질까?

이유:
→ 엣지는 이미지에서 가장 중요한 정보
→ 고양이를 구분하려면 윤곽선이 필요
→ 손실을 줄이려면 엣지를 감지해야 함
→ 자연스럽게 엣지 검출 필터가 학습됨

놀라운 점:
→ 아무도 "엣지를 찾아라"라고 가르치지 않음
→ 데이터와 손실 함수만 주면
→ AI가 알아서 "엣지가 중요하구나"를 발견</div>

            <div class="chat">
                <div class="a">
                    <p>이게 바로 <span class="key-point">표현 학습(Representation Learning)</span>이야.</p>
                    <p>사람이 "뭘 봐야 하는지" 알려주지 않아도, AI가 스스로 중요한 특징을 찾아내는 거지.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 4. 층마다 다른 필터</h2>

            <div class="chat">
                <div class="q">모든 층의 필터가 비슷해?</div>
                <div class="a">
                    <p><span class="highlight">완전히 달라!</span></p>
                </div>
            </div>

            <div class="code-block">층별 필터 특징:

첫 번째 층:
→ 단순한 패턴 (엣지, 색상 변화)
→ 예: 수직선, 수평선, 대각선
→ 사람이 설계한 Sobel 필터와 비슷

두 번째 층:
→ 조금 복잡한 패턴 (코너, 원, 질감)
→ 첫 번째 층의 출력을 조합

세 번째 층:
→ 더 복잡 (눈, 귀, 털 패턴)
→ 객체의 부분

네 번째 층 이상:
→ 매우 복잡 (얼굴, 몸통 전체)
→ 완전한 객체 부분</div>

            <div class="chat">
                <div class="q">왜 이렇게 단계적으로 학습돼?</div>
                <div class="a">
                    <p>층이 쌓일수록 <strong>수용 영역(Receptive Field)</strong>이 커지거든.</p>
                </div>
            </div>

            <div class="code-block">수용 영역:

Layer 1 (3×3 필터):
→ 한 번에 3×3 영역만 봄
→ 작은 패턴만 학습 가능

Layer 2:
→ Layer 1의 출력을 입력으로 받음
→ 실제로는 5×5 영역을 보는 효과
→ 조금 더 큰 패턴

Layer 3:
→ 7×7 영역
→ 더 큰 패턴

Layer 10:
→ 수십×수십 영역
→ 전체 객체 파악</div>
        </div>

        <div class="conversation">
            <h2>Part 5. 실제 학습된 필터 보기</h2>

            <div class="chat">
                <div class="q">실제 필터는 어떻게 생겼어?</div>
                <div class="a">
                    <p>AlexNet 첫 번째 층의 실제 필터를 보면:</p>
                </div>
            </div>

            <div class="code-block">Layer 1 필터 시각화:

필터 1: 수직 엣지 검출
[1, 0, -1]
[1, 0, -1]
[1, 0, -1]

필터 2: 수평 엣지 검출
[1, 1, 1]
[0, 0, 0]
[-1, -1, -1]

필터 3: 대각선 엣지
[1, 1, 0]
[1, 0, -1]
[0, -1, -1]

필터 4: 빨간색 감지
→ R 채널에 큰 값
→ G, B 채널에 작은 값

...64개 필터 각각 다른 패턴</div>

            <div class="chat">
                <div class="a">
                    <p>놀라운 건, 이 필터들이 <span class="highlight">사람이 설계한 전통 필터와 매우 유사</span>하다는 거야.</p>
                    <p>수십 년간 연구자들이 수동으로 만든 필터와 거의 똑같은 걸 AI가 자동으로 찾아낸 거지.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 6. 데이터가 중요한 이유</h2>

            <div class="chat">
                <div class="q">그럼 데이터만 많으면 필터가 잘 학습돼?</div>
                <div class="a">
                    <p><span class="key-point">맞아. 데이터가 핵심이야.</span></p>
                </div>
            </div>

            <div class="code-block">데이터 양에 따른 차이:

적은 데이터 (1000장):
→ 필터가 과적합
→ 학습 데이터의 특정 패턴만 외움
→ 일반화 성능 낮음

중간 데이터 (10,000장):
→ 기본적인 필터 학습
→ 엣지, 코너 정도는 찾음
→ 실용적 성능

많은 데이터 (100만 장):
→ 다양한 패턴 학습
→ 엣지, 질감, 부분, 전체 모두 학습
→ 높은 일반화 성능

ImageNet (1400만 장):
→ 거의 완벽한 필터
→ 다른 task에도 전이 가능
→ 사전 학습 모델로 활용</div>

            <div class="chat">
                <div class="a">
                    <p>그래서 <strong>"데이터가 왕"</strong>이라는 말이 나온 거야.</p>
                    <p>좋은 필터는 사람이 설계하는 게 아니라, <span class="highlight">좋은 데이터가 만들어내는 거야.</span></p>
                </div>
            </div>
        </div>

        <div class="summary-box">
            <h3>핵심 정리</h3>
            <ul>
                <li><strong>필터는 학습 가능한 파라미터</strong> - 랜덤 초기화 후 자동 최적화</li>
                <li><strong>역전파로 학습</strong> - 일반 신경망과 동일한 방식</li>
                <li><strong>자동 특징 추출</strong> - 사람이 설계하지 않아도 엣지 검출기 생성</li>
                <li><strong>계층적 학습</strong> - 층마다 단순→복잡한 특징 자동 학습</li>
                <li><strong>데이터가 핵심</strong> - 많은 데이터가 좋은 필터를 만듦</li>
                <li><strong>표현 학습</strong> - AI가 스스로 중요한 특징 발견</li>
            </ul>
        </div>

        <div class="nav-links">
            <a href="../topic05/">← 이전: CNN은 왜 이미지에 강해?</a>
            <a href="../topic07/">다음: 풀링은 왜 해? →</a>
        </div>
    </div>
</body>
</html>
