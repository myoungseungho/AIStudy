<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>전이 학습이 뭐야? - Section 5</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fafafa;
            color: #333;
            line-height: 1.9;
        }
        .container { max-width: 800px; margin: 0 auto; padding: 60px 20px; }
        .breadcrumb { margin-bottom: 24px; font-size: 0.9rem; }
        .breadcrumb a { color: #666; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .breadcrumb span { color: #999; margin: 0 8px; }
        .header { margin-bottom: 48px; }
        .topic-number {
            display: inline-block;
            background: #00BCD4;
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 16px;
        }
        .header h1 { font-size: 2rem; font-weight: 700; color: #111; margin-bottom: 12px; }
        .header p { color: #666; font-size: 1.1rem; }
        .conversation {
            background: white;
            border-radius: 16px;
            padding: 32px;
            margin: 32px 0;
            border: 1px solid #e0e0e0;
        }
        .conversation h2 {
            font-size: 1.3rem;
            color: #00BCD4;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e0f7fa;
        }
        .chat { margin-bottom: 20px; }
        .q {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 16px 20px;
            margin: 16px 0;
            border-radius: 0 12px 12px 0;
            font-weight: 500;
        }
        .q::before { content: "Q. "; color: #e65100; font-weight: 700; }
        .a {
            padding: 8px 0 8px 20px;
            border-left: 4px solid #e0e0e0;
            margin: 12px 0;
        }
        .a p { margin-bottom: 12px; }
        .a p:last-child { margin-bottom: 0; }
        .highlight {
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #1565c0;
        }
        .key-point {
            background: #e0f7fa;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #00838f;
        }
        .warning {
            background: #ffcdd2;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            color: #c62828;
        }
        .code-block {
            background: #263238;
            border-radius: 8px;
            padding: 16px 20px;
            margin: 16px 0;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            color: #eceff1;
            overflow-x: auto;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .compare-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 0.9rem;
        }
        .compare-table th, .compare-table td {
            padding: 12px;
            border: 1px solid #e0e0e0;
            text-align: left;
        }
        .compare-table th { background: #f5f5f5; font-weight: 600; }
        .summary-box {
            background: linear-gradient(135deg, #00BCD4 0%, #26C6DA 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            margin: 32px 0;
        }
        .summary-box h3 { font-size: 1.2rem; margin-bottom: 20px; }
        .summary-box ul { list-style: none; }
        .summary-box li {
            padding: 8px 0;
            padding-left: 24px;
            position: relative;
        }
        .summary-box li::before {
            content: "→";
            position: absolute;
            left: 0;
            color: #b2ebf2;
        }
        .nav-links {
            display: flex;
            justify-content: space-between;
            margin-top: 60px;
            padding-top: 24px;
            border-top: 1px solid #e0e0e0;
        }
        .nav-links a { color: #00BCD4; text-decoration: none; font-weight: 500; }
        .nav-links a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <nav class="breadcrumb">
            <a href="../../">AI 공부</a>
            <span>/</span>
            <a href="../">Section 5</a>
            <span>/</span>
            Topic 10
        </nav>

        <header class="header">
            <div class="topic-number">TOPIC 10</div>
            <h1>전이 학습이 뭐야?</h1>
            <p>Q. 남이 학습한 모델을 가져다 쓸 수 있어?</p>
        </header>

        <div class="conversation">
            <h2>Part 1. 전이 학습(Transfer Learning)이란?</h2>

            <div class="chat">
                <div class="q">전이 학습이 뭐야?</div>
                <div class="a">
                    <p><span class="key-point">이미 학습된 모델을 재활용하는 거야.</span></p>
                    <p>처음부터 학습하지 않고, 남이 만든 모델을 가져와서 내 문제에 맞게 조금만 수정하는 거지.</p>
                </div>
            </div>

            <div class="code-block">비유:
수학 공부를 한다고 해보자.

처음부터 학습:
→ 1+1부터 시작
→ 덧셈, 뺄셈, 곱셈, 나눗셈
→ 대수, 기하, 미적분
→ 10년 걸림

전이 학습:
→ 수학 전문가가 이미 10년 공부함
→ 그 지식을 물려받음
→ 내가 필요한 부분(통계)만 추가로 공부
→ 1년이면 충분</div>

            <div class="chat">
                <div class="a">
                    <p><span class="highlight">AI도 똑같아.</span></p>
                    <p>ImageNet으로 이미 학습된 모델을 가져다가,</p>
                    <p>내 데이터(예: 강아지 품종 분류)로 조금만 추가 학습하면 돼.</p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 2. 왜 전이 학습을 써?</h2>

            <div class="chat">
                <div class="q">왜 처음부터 안 하고 전이 학습을 해?</div>
                <div class="a">
                    <p>세 가지 큰 이유가 있어.</p>
                </div>
            </div>

            <table class="compare-table">
                <tr>
                    <th>문제</th>
                    <th>처음부터 학습</th>
                    <th>전이 학습</th>
                </tr>
                <tr>
                    <td><strong>데이터</strong></td>
                    <td>수백만 장 필요</td>
                    <td>수백~수천 장으로 가능</td>
                </tr>
                <tr>
                    <td><strong>시간</strong></td>
                    <td>수일~수주</td>
                    <td>수시간~하루</td>
                </tr>
                <tr>
                    <td><strong>비용</strong></td>
                    <td>GPU 며칠 돌림</td>
                    <td>GPU 몇 시간</td>
                </tr>
                <tr>
                    <td><strong>성능</strong></td>
                    <td>데이터 부족 시 낮음</td>
                    <td>적은 데이터로도 높음</td>
                </tr>
            </table>

            <div class="code-block">예시:

개 품종 분류기를 만든다고 하자.

처음부터:
→ 수백만 장 개 사진 필요
→ ImageNet 수준 데이터셋 구축
→ ResNet 3일 학습
→ 정확도 85%

전이 학습:
→ ImageNet 학습된 ResNet 다운로드
→ 품종별 100장씩만 수집 (총 2,000장)
→ 3시간 Fine-tuning
→ 정확도 92%

차이가 엄청나지?</div>
        </div>

        <div class="conversation">
            <h2>Part 3. 어떻게 작동해?</h2>

            <div class="chat">
                <div class="q">구체적으로 어떻게 하는 거야?</div>
                <div class="a">
                    <p>두 가지 방법이 있어.</p>
                </div>
            </div>

            <div class="code-block">방법 1: Feature Extractor (특징 추출기)

ImageNet 학습 모델:
[Input] → Conv1 → Conv2 → ... → Conv5 → FC → [1000 classes]

내 모델로 변환:
[Input] → Conv1 → Conv2 → ... → Conv5 → NEW FC → [10 classes]
         └────────── 고정(freeze) ──────────┘  └─ 학습 ─┘

→ 합성곱 층은 그대로 두고 (가중치 동결)
→ 마지막 분류기만 새로 학습


방법 2: Fine-tuning (미세 조정)

[Input] → Conv1 → Conv2 → ... → Conv5 → NEW FC → [10 classes]
         └─ 고정 ─┘  └──────── 천천히 학습 ─────────┘

→ 초반 층은 고정
→ 후반 층은 작은 learning rate로 조금만 수정
→ 마지막 층은 완전히 새로 학습</div>

            <div class="chat">
                <div class="a">
                    <p><span class="key-point">핵심: 초반 층(엣지, 코너)은 범용적이라 그대로 써.</span></p>
                    <p><span class="key-point">후반 층(객체 인식)만 내 데이터에 맞게 조정.</span></p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 4. 왜 초반 층은 고정해?</h2>

            <div class="chat">
                <div class="q">왜 초반 층은 건드리지 않아?</div>
                <div class="a">
                    <p><strong>초반 층은 범용적인 특징</strong>을 학습했기 때문이야.</p>
                </div>
            </div>

            <div class="code-block">층별 학습 내용:

Layer 1-2: 엣지, 코너, 색상
→ 고양이든, 자동차든, 비행기든 다 똑같음
→ 범용적!
→ 고정해도 문제없음

Layer 3-4: 질감, 패턴, 부분
→ 털, 바퀴, 날개 등
→ 약간 다르지만 비슷함
→ 조금만 조정

Layer 5 + FC: 최종 객체
→ "고양이" vs "자동차"
→ 완전히 다름
→ 새로 학습 필요


결론:
→ 데이터 많음: Fine-tuning
→ 데이터 적음: Feature Extractor만</div>
        </div>

        <div class="conversation">
            <h2>Part 5. 실전 사용법</h2>

            <div class="code-block">실제 코드 예시 (PyTorch):

import torchvision.models as models

# 1. 사전 학습 모델 다운로드
model = models.resnet50(pretrained=True)

# 2. 마지막 층 교체
num_classes = 10  # 내 문제의 클래스 수
model.fc = nn.Linear(model.fc.in_features, num_classes)

# 3-A. Feature Extractor: 합성곱 층 고정
for param in model.parameters():
    param.requires_grad = False
model.fc.requires_grad = True  # 마지막 층만 학습

# 3-B. Fine-tuning: 전체 학습, 작은 lr
optimizer = optim.Adam([
    {'params': model.layer4.parameters(), 'lr': 1e-4},
    {'params': model.fc.parameters(), 'lr': 1e-3}
])

# 4. 학습
train(model, my_data, optimizer)</div>

            <div class="chat">
                <div class="a">
                    <p><span class="highlight">단 몇 줄로 ImageNet의 지식을 물려받는 거야!</span></p>
                </div>
            </div>
        </div>

        <div class="conversation">
            <h2>Part 6. 언제 전이 학습이 안 될까?</h2>

            <div class="chat">
                <div class="q">항상 전이 학습이 좋아?</div>
                <div class="a">
                    <p><span class="warning">아니. 데이터가 너무 다르면 안 돼.</span></p>
                </div>
            </div>

            <div class="code-block">전이 학습 적합성:

✅ 적합:
→ ImageNet(자연 이미지) → 개 품종 분류
→ ImageNet → 자동차 모델 분류
→ ImageNet → 음식 분류
→ 모두 자연 이미지, 엣지/질감 공통

❌ 부적합:
→ ImageNet → 의료 X-ray 분석
  (흑백, 완전히 다른 특징)
→ ImageNet → 위성 사진 분석
  (하늘에서 본 뷰, 다른 시점)
→ ImageNet → 현미경 이미지
  (미세 구조, 다른 스케일)


해결책:
→ 비슷한 도메인의 사전 학습 모델 찾기
→ 예: 의료 이미지는 ChestX-ray 사전 학습 모델
→ 없으면 처음부터 학습</div>

            <div class="chat">
                <div class="a">
                    <p><span class="key-point">원칙: 원본 데이터와 내 데이터가 비슷해야 효과적</span></p>
                </div>
            </div>
        </div>

        <div class="summary-box">
            <h3>핵심 정리</h3>
            <ul>
                <li><strong>전이 학습 = 지식 재활용</strong> - 학습된 모델을 내 문제에 적용</li>
                <li><strong>데이터, 시간, 비용 절약</strong> - 수백만 장→수백 장으로도 가능</li>
                <li><strong>Feature Extractor</strong> - 합성곱 층 고정, 분류기만 학습</li>
                <li><strong>Fine-tuning</strong> - 후반 층을 작은 lr로 조금 조정</li>
                <li><strong>초반 층은 범용적</strong> - 엣지, 코너는 모든 이미지에 공통</li>
                <li><strong>도메인 유사성 중요</strong> - 너무 다른 데이터는 효과 없음</li>
            </ul>
        </div>

        <div class="nav-links">
            <a href="../topic09/">← 이전: 특징 맵이 뭐야?</a>
            <a href="../topic11/">다음: ImageNet은 뭐야? →</a>
        </div>
    </div>
</body>
</html>
